define("metaphorjs-animate",["metaphorjs-promise"],function(F){var z=function(){var a=["Moz","Webkit","ms","O","Khtml"],b="animationDelay",c="animationDuration",f="transitionDelay",e="transitionDuration",k="transform",g=null;(function(){var l=document.createElement("div"),h=!1,d,p,C;if(void 0!==l.style.animationName)h=!0;else for(p=0,C=a.length;p<C;p++)if(d=a[p],void 0!==l.style[d+"AnimationName"]){h=!0;b=d+"AnimationDelay";c=d+"AnimationDuration";f=d+"TransitionDelay";e=d+"TransitionDuration";k=
d+"Transform";break}return h})()&&(g={animationDelay:b,animationDuration:c,transitionDelay:f,transitionDuration:e,transform:k});return function(){return g}}(),M=function(){var a=function(b){if(!b)return 0;var a=parseFloat(b);-1==b.indexOf("ms")&&(a*=1E3);return a},b=function(b,c,d){var p,e,f=c.length;for(p=0;p<f;p++)e=a(c[p])+a(d[p]),b=Math.max(e,b);return b},c=z(),f=c?c.animationDuration:null,e=c?c.animationDelay:null,k=c?c.transitionDuration:null,g=c?c.transitionDelay:null;return function(a){if(!c)return 0;
var h=window.getComputedStyle?window.getComputedStyle(a,null):a.style;a=0;var d=(h[f]||"").split(","),p=(h[e]||"").split(","),C=(h[k]||"").split(","),h=(h[g]||"").split(",");a=Math.max(a,b(a,d,p));return a=Math.max(a,b(a,C,h))}}(),N=function(){var a=["0","0","0"];return function(){for(var b=a.length,c;b;){b--;c=a[b].charCodeAt(0);if(57==c)return a[b]="A",a.join("");if(90==c)a[b]="0";else return a[b]=String.fromCharCode(c+1),a.join("")}a.unshift("0");return a.join("")}}(),q=function(){var a={};return function(b,
c,f){b=b._mjsid||(b._mjsid=N());var e=a[b];return void 0!==f?(e||(e=a[b]={}),e[c]=f):e?e[c]:void 0}}(),I=function(){var a={};return function(b){return a[b]||(a[b]=new RegExp(b))}}(),x=function(a,b){b&&(a.className=a.className.replace(I("(?:^|\\s)"+b+"(?!\\S)"),""))},A=function(a){return"function"==typeof a},O=Object.prototype.toString,B=function(){var a={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};
return function(b){if(!b){if(null===b)return 6;if(void 0===b)return 7}var c=a[O.call(b)];return void 0===c?-1:1==c&&isNaN(b)?8:c}}(),P=function(a){var b=q(a,"mjsAnimationQueue"),c,f;if("object"==typeof b&&5===B(b)&&b.length){if(b=b[0])b.stages&&(c=b.position,f=b.stages,x(a,f[c]),x(a,f[c]+"-active")),b.deferred&&b.deferred.reject(b.el)}else A(b)?b(a):"stop"==b&&$(a).stop(!0,!0);q(a,"mjsAnimationQueue",null)},Q=function(a){var b,c;(c=!a)||(null===a||"object"!=typeof a?c=!1:(c=B(a),c=2<c||-1==c),c=!c&&
!A(a));return c?!1:A(b=a.then)?b:!1},R=Array.prototype.slice,D=function(a){return"object"==typeof a&&3===B(a)&&!a.nodeType},J=function(a){return!0===a||!1===a},K=function(){return function b(){var c=!1,f=!1,e=R.call(arguments),k=e.shift(),g,l,h;J(e[e.length-1])&&(c=e.pop());J(e[e.length-1])&&(f=c,c=e.pop());for(;e.length;)if(g=e.shift())for(l in g)if(g.hasOwnProperty(l)&&void 0!==(h=g[l]))if(f)if(k[l]&&D(k[l])&&D(h))b(k[l],h,c,f);else{if(!0===c||void 0==k[l])D(h)?(k[l]={},b(k[l],h,c,!0)):k[l]=h}else if(!0===
c||void 0==k[l])k[l]=h;return k}}(),L=function(a,b){var c;if(c=b)c=!(b&&I("(?:^|\\s)"+b+"(?!\\S)").test(a.className));c&&(a.className+=" "+b)},G=function(a){return"string"==typeof a||0===B(a)};(function(){if(void 0!==window.pageYOffset)return function(){return window.pageYOffset};var a=document.body,b=document.documentElement;return b.clientHeight?function(){return b.scrollTop}:function(){return a.scrollTop}})();(function(){if(void 0!==window.pageXOffset)return function(){return window.pageXOffset};
var a=document.body,b=document.documentElement;return b.clientWidth?function(){return b.scrollLeft}:function(){return a.scrollLeft}})();var S=function(a,b,c){setTimeout(function(){a.apply(b,c||[])},0)},u="undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:S;return function(){var a={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},b=0,c=z(),f=!!c,e=function(a,b,d){var c=function(){(new Date).getTime()-b>=d?a():u(c)};u(c)},
k=function h(a,b,c,f,g,m,y,v){var w=function(){var b=q(a,"mjsAnimationQueue");return b&&b.length&&b[0].id==y?!1:(g.reject(a),!0)},r=function(){if(!w()){var e=c;c++;if(c==b.length){g.resolve(a);q(a,"mjsAnimationQueue").shift();var f=q(a,"mjsAnimationQueue");f.length?(f=f[0],k(f.el,f.stages,0,f.start,f.deferred,!1,f.id,f.step)):q(a,"mjsAnimationQueue",null)}else q(a,"mjsAnimationQueue")[0].position=c,h(a,b,c,null,g,!1,y,v);x(a,b[e]);x(a,b[e]+"-active")}},n=function(){w()||(L(a,b[c]+"-active"),F.resolve(v&&
v(a,c,"active")).done(function(){if(!w()){var b=M(a);b?e(r,(new Date).getTime(),b):u(r)}}))},t=function(){w()||(L(a,b[c]),F.waterfall([v&&v(a,c,"start"),function(){return f?f(a):null}]).done(function(){!w()&&u(n)}))};m?u(t):t()},g=function(c,d,e,g,u,x){var m=new F,y=q(c,"mjsAnimationQueue")||[],v=++b,w=c.getAttribute("mjs-animate"),r,n,t,E,s,z,H;d=d||w;g&&null===w&&(d=null);if(d){G(d)?"["==d.substr(0,1)?r=(new Function("","return "+d))():(r=a[d],d=u&&u.get("animate."+d,!0)):A(d)?n=d:"object"==typeof d&&
5===B(d)&&(G(d[0])?r=d:(t=d[0],E=d[1]));D(d)&&(r=d.stages,n=d.fn,t=d.before,E=d.after,s=d.options?K({},d.options):{},z=d.context||null,H=d.duration||null,e=e||s.start);if(f&&r)return y.push({el:c,stages:r,start:e,step:x,deferred:m,position:0,id:v}),q(c,"mjsAnimationQueue",y),1==y.length&&k(c,r,0,e,m,!0,v,x),m;s=s||{};e&&(s.start=function(){e(c)});s.complete=function(){m.resolve(c)};H&&(s.duration=H);if(n&&A(n))return t&&K(c.style,t,!0,!1),e&&e(c),q(c,"mjsAnimationQueue",n.call(z,c,function(){m.resolve(c)})),
m;if(window.jQuery){d=$(c);t&&d.css(t);q(c,"mjsAnimationQueue","stop");if(n&&G(n))return d[n](s),m;if(E)return d.animate(E,s),m}}e?(n=e(c),Q(n)?n.done(function(){m.resolve(c)}):m.resolve(c)):m.resolve(c);return m};g.addAnimationType=function(b,c){a[b]=c};g.stop=P;g.prefixes=c;g.cssAnimations=f;return g}()});
