'use strict';define("metaphorjs-animate",["metaphorjs-promise"],function(D){function x(a,c){c&&(a.className=a.className.replace(z("(?:^|\\s)"+c+"(?!\\S)"),""))}function A(a){return"function"==typeof a}function L(a){if(!a||!a.then)return!1;var c,b;return"object"!=(b=typeof a)&&"function"!=b?!1:A(c=a.then)?c:!1}function B(a){return"object"==typeof a&&3===E(a)&&!a.nodeType&&a.constructor===Object}function H(a){return!0===a||!1===a}function I(a,c){var b;if(b=c)b=!(c&&z("(?:^|\\s)"+c+"(?!\\S)").test(a.className));
b&&(a.className+=" "+c)}function F(a){return"string"==typeof a||a===""+a}var J=function(){var a=["Moz","Webkit","ms","O","Khtml"],c="animationDelay",b="animationDuration",f="transitionDelay",e="transitionDuration",l="transform",m=null,h=null;(function(){var k=document.createElement("div"),d=!1,n,h,g;if(void 0!==k.style.animationName)d=!0;else for(h=0,g=a.length;h<g;h++)if(n=a[h],void 0!==k.style[n+"AnimationName"]){d=!0;c=n+"AnimationDelay";b=n+"AnimationDuration";f=n+"TransitionDelay";e=n+"TransitionDuration";
l=n+"Transform";break}d&&("ontransitionend"in window?m="transitionend":"onwebkittransitionend"in window&&(m="webkitTransitionEnd"));return d})()&&(h={animationDelay:c,animationDuration:b,transitionDelay:f,transitionDuration:e,transform:l,transitionend:m});return function(){return h}}(),M=function(){var a=function(a){if(!a)return 0;var c=parseFloat(a);-1==a.indexOf("ms")&&(c*=1E3);return c},c=function(c,b,d){var n,e,f=b.length;for(n=0;n<f;n++)e=a(b[n])+a(d[n]),c=Math.max(e,c);return c},b=J(),f=b?b.animationDuration:
null,e=b?b.animationDelay:null,l=b?b.transitionDuration:null,m=b?b.transitionDelay:null;return function(a){if(!b)return 0;var k=window.getComputedStyle?window.getComputedStyle(a,null):a.style;a=0;var d=(k[f]||"").split(","),n=(k[e]||"").split(","),g=(k[l]||"").split(","),k=(k[m]||"").split(",");a=Math.max(a,c(a,d,n));return a=Math.max(a,c(a,g,k))}}(),N=function(){var a=["0","0","0"];return function(){for(var c=a.length,b;c;){c--;b=a[c].charCodeAt(0);if(57==b)return a[c]="A",a.join("");if(90==b)a[c]=
"0";else return a[c]=String.fromCharCode(b+1),a.join("")}a.unshift("0");return a.join("")}}(),g=function(){var a={};return function(c,b,f){c=c._mjsid||(c._mjsid=N());var e=a[c];return void 0!==f?(e||(e=a[c]={}),e[b]=f):e?e[b]:void 0}}(),z=function(){var a={};return function(c){return a[c]||(a[c]=new RegExp(c))}}(),O=Object.prototype.toString,E=function(){var a={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,
"[object Date]":10};return function(c){if(!c){if(null===c)return 6;if(void 0===c)return 7}var b=a[O.call(c)];return void 0===b?-1:1==b&&isNaN(c)?8:b}}(),P=function(a){var c=g(a,"mjsAnimationQueue"),b,f;if("object"==typeof c&&5===E(c)&&c.length){if(c=c[0])c.stages&&(b=c.position,f=c.stages,x(a,f[b]),x(a,f[b]+"-active")),c.deferred&&c.deferred.reject(c.el)}else A(c)?c(a):"stop"==c&&$(a).stop(!0,!0);g(a,"mjsAnimationQueue",null)},Q=Array.prototype.slice,K=function(){return function c(){var b=!1,f=!1,
e=Q.call(arguments),l=e.shift(),g,h,k;H(e[e.length-1])&&(b=e.pop());H(e[e.length-1])&&(f=b,b=e.pop());for(;e.length;)if(g=e.shift())for(h in g)if(g.hasOwnProperty(h)&&void 0!==(k=g[h]))if(f)if(l[h]&&B(l[h])&&B(k))c(l[h],k,b,f);else{if(!0===b||void 0==l[h])B(k)?(l[h]={},c(l[h],k,b,!0)):l[h]=k}else if(!0===b||void 0==l[h])l[h]=k;return l}}(),u=function(){var a,c;if("undefined"!=typeof window){var b=window;a=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame;c=b.cancelAnimationFrame||
b.webkitCancelAnimationFrame||b.mozCancelAnimationFrame||b.webkitCancelRequestAnimationFrame;if(a)return function(b){var e=a(b);return function(){c(e)}}}return function(a){var c=setTimeout(a,0);return function(){clearTimeout(c)}}}();return function(){var a={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},c=0,b=J(),f=!!b,e=function(a,c,d){var b=function(){(new Date).getTime()-c>=d?a():u(b)};u(b)},l=function k(a,c,b,f,m,p,y,v){var w=function(){var c=g(a,
"mjsAnimationQueue");return c&&c.length&&c[0].id==y?!1:(m.reject(a),!0)},r=function(){if(!w()){var e=b;b++;if(b==c.length){m.resolve(a);g(a,"mjsAnimationQueue").shift();var f=g(a,"mjsAnimationQueue");f.length?(f=f[0],l(f.el,f.stages,0,f.start,f.deferred,!1,f.id,f.step)):g(a,"mjsAnimationQueue",null)}else g(a,"mjsAnimationQueue")[0].position=b,k(a,c,b,null,m,!1,y,v);x(a,c[e]);x(a,c[e]+"-active")}},q=function(){w()||(I(a,c[b]+"-active"),D.resolve(v&&v(a,b,"active")).done(function(){if(!w()){var c=M(a);
c?e(r,(new Date).getTime(),c):u(r)}}))},t=function(){w()||(I(a,c[b]),D.waterfall([v&&v(a,b,"start"),function(){return f?f(a):null}]).done(function(){!w()&&u(q)}))};p?u(t):t()},m=function(b,d,e,m,u,x){var p=new D,y=g(b,"mjsAnimationQueue")||[],v=++c,w=b.getAttribute("mjs-animate"),r,q,t,C,s,z,G;d=d||w;m&&null===w&&(d=null);if(d){F(d)?"["==d.substr(0,1)?r=(new Function("","return "+d))():(r=a[d],d=u&&u.get("animate."+d,!0)):A(d)?q=d:"object"==typeof d&&5===E(d)&&(F(d[0])?r=d:(t=d[0],C=d[1]));B(d)&&
(r=d.stages,q=d.fn,t=d.before,C=d.after,s=d.options?K({},d.options):{},z=d.context||null,G=d.duration||null,e=e||s.start);if(f&&r)return y.push({el:b,stages:r,start:e,step:x,deferred:p,position:0,id:v}),g(b,"mjsAnimationQueue",y),1==y.length&&l(b,r,0,e,p,!0,v,x),p;s=s||{};e&&(s.start=function(){e(b)});s.complete=function(){p.resolve(b)};G&&(s.duration=G);if(q&&A(q))return t&&K(b.style,t,!0,!1),e&&e(b),g(b,"mjsAnimationQueue",q.call(z,b,function(){p.resolve(b)})),p;if(window.jQuery){d=$(b);t&&d.css(t);
g(b,"mjsAnimationQueue","stop");if(q&&F(q))return d[q](s),p;if(C)return d.animate(C,s),p}}e?(q=e(b),L(q)?q.done(function(){p.resolve(b)}):p.resolve(b)):p.resolve(b);return p};m.addAnimationType=function(b,c){a[b]=c};m.stop=P;m.prefixes=b;m.cssAnimations=f;return m}()});
