'use strict';(function(){function y(e,c){c&&(e.className=e.className.replace(C("(?:^|\\s)"+c+"(?!\\S)"),""))}function n(e){return"function"==typeof e}function p(e){if(!e||!e.then)return!1;var c,f;return"object"!=(f=typeof e)&&"function"!=f?!1:n(c=e.then)?c:!1}function D(e){return"object"==typeof e&&3===E(e)&&!e.nodeType&&e.constructor===Object}function J(e){return!0===e||!1===e}function O(e,c,f,k){setTimeout(function(){e.apply(c,f||[])},k||0)}function z(e){var c=e.stack||Error().stack;if("undefined"!=
typeof console&&console.log)O(function(){console.log(e);c&&console.log(c)});else throw e;}function K(e,c){var f;if(f=c)f=!(c&&C("(?:^|\\s)"+c+"(?!\\S)").test(e.className));f&&(e.className+=" "+c)}function F(e){return"string"==typeof e||e===""+e}var u={lib:{},cmp:{},view:{}},M=function(){var e=["Moz","Webkit","ms","O","Khtml"],c="animationDelay",f="animationDuration",k="transitionDelay",h="transitionDuration",l="transform",g=null,b=null;(function(){var a=document.createElement("div"),b=!1,A,B,L;if(void 0!==
a.style.animationName)b=!0;else for(B=0,L=e.length;B<L;B++)if(A=e[B],void 0!==a.style[A+"AnimationName"]){b=!0;c=A+"AnimationDelay";f=A+"AnimationDuration";k=A+"TransitionDelay";h=A+"TransitionDuration";l=A+"Transform";break}b&&("ontransitionend"in window?g="transitionend":"onwebkittransitionend"in window&&(g="webkitTransitionEnd"));return b})()&&(b={animationDelay:c,animationDuration:f,transitionDelay:k,transitionDuration:h,transform:l,transitionend:g});return function(){return b}}(),P=function(){var e=
function(b){if(!b)return 0;var a=parseFloat(b);-1==b.indexOf("ms")&&(a*=1E3);return a},c=function(b,a,d){var c,f,g=a.length;for(c=0;c<g;c++)f=e(a[c])+e(d[c]),b=Math.max(f,b);return b},f=M(),k=f?f.animationDuration:null,h=f?f.animationDelay:null,l=f?f.transitionDuration:null,g=f?f.transitionDelay:null;return function(b){if(!f)return 0;var a=window.getComputedStyle?window.getComputedStyle(b,null):b.style;b=0;var d=(a[k]||"").split(","),e=(a[h]||"").split(","),B=(a[l]||"").split(","),a=(a[g]||"").split(",");
b=Math.max(b,c(b,d,e));return b=Math.max(b,c(b,B,a))}}(),Q=function(){var e=["0","0","0"];return function(){for(var c=e.length,f;c;){c--;f=e[c].charCodeAt(0);if(57==f)return e[c]="A",e.join("");if(90==f)e[c]="0";else return e[c]=String.fromCharCode(f+1),e.join("")}e.unshift("0");return e.join("")}}(),s=function(){var e={};return function(c,f,k){c=c._mjsid||(c._mjsid=Q());var h=e[c];return void 0!==k?(h||(h=e[c]={}),h[f]=k):h?h[f]:void 0}}(),C=function(){var e={};return function(c){return e[c]||(e[c]=
new RegExp(c))}}(),R=Object.prototype.toString,E=function(){var e={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(c){if(!c){if(null===c)return 6;if(void 0===c)return 7}var f=e[R.call(c)];return void 0===f?-1:1==f&&isNaN(c)?8:f}}(),N=function(e){var c=s(e,"mjsAnimationQueue"),f,k;if("object"==typeof c&&5===E(c)&&c.length){if(c=c[0])c.stages&&(f=c.position,k=c.stages,y(e,
k[f]),y(e,k[f]+"-active")),c.deferred&&c.deferred.reject(c.el)}else n(c)?c(e):"stop"==c&&$(e).stop(!0,!0);s(e,"mjsAnimationQueue",null)},S=Array.prototype.slice,G=function(){return function c(){var f=!1,k=!1,h=S.call(arguments),l=h.shift(),g,b,a;J(h[h.length-1])&&(f=h.pop());J(h[h.length-1])&&(k=f,f=h.pop());for(;h.length;)if(g=h.shift())for(b in g)if(g.hasOwnProperty(b)&&void 0!==(a=g[b]))if(k)if(l[b]&&D(l[b])&&D(a))c(l[b],a,f,k);else{if(!0===f||void 0==l[b])D(a)?(l[b]={},c(l[b],a,f,!0)):l[b]=a}else if(!0===
f||void 0==l[b])l[b]=a;return l}}(),m=Function.prototype.bind?function(e,c){return e.bind(c)}:function(e,c){return function(){return e.apply(c,arguments)}},H=function(){var e=[],c=!1,f="undefined"!=typeof process?process.nextTick:function(b){setTimeout(b,0)},k=function(){c=!0;var b=e.shift();f(function(){b[0].apply(b[1],b[2]);e.length?k():c=!1},0)},h=function(b,a,d){d=d||[];e.push([b,a,d]);c||k()},l=function(b,a){return function(d){try{a.resolve(b(d))}catch(c){a.reject(c)}}},g=function(b,a){if(b instanceof
g)return b;if(!(this instanceof g))return new g(b,a);var d;this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(0<arguments.length)if(d=p(b))b instanceof g?b.then(m(this.resolve,this),m(this.reject,this)):(new g(d,b)).then(m(this.resolve,this),m(this.reject,this));else if(n(b))try{b.call(a,m(this.resolve,this),m(this.reject,this))}catch(c){this.reject(c)}else this.resolve(b)};G(g.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,
_triggered:!1,isPending:function(){return 0==this._state},isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){this._fails=this._dones=this._rejects=this._fulfills=null},_processValue:function(b,a){var d;if(0==this._state)if(b===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(d=p(b)){b instanceof g?b.then(m(this._processResolveValue,this),m(this._processRejectReason,this)):(new g(d,b)).then(m(this._processResolveValue,
this),m(this._processRejectReason,this));return}}catch(c){0==this._state&&this._doReject(c);return}a.call(this,b)}},_callResolveHandlers:function(){this._done();for(var b=this._fulfills,a;a=b.shift();)h(a[0],a[1],[this._value]);this._cleanup()},_doResolve:function(b){this._value=b;this._state=1;0==this._wait&&this._callResolveHandlers()},_processResolveValue:function(b){this._processValue(b,this._doResolve)},resolve:function(b){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(b);
return this},_callRejectHandlers:function(){this._fail();for(var b=this._rejects,a;a=b.shift();)h(a[0],a[1],[this._reason]);this._cleanup()},_doReject:function(b){this._state=2;this._reason=b;0==this._wait&&this._callRejectHandlers()},_processRejectReason:function(b){this._processValue(b,this._doReject)},reject:function(b){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(b);return this},then:function(b,a){var d=new g,c=this._state;0==c||0!=this._wait?(b&&n(b)?this._fulfills.push([l(b,
d),null]):this._fulfills.push([d.resolve,d]),a&&n(a)?this._rejects.push([l(a,d),null]):this._rejects.push([d.reject,d])):1==c?b&&n(b)?h(l(b,d),null,[this._value]):d.resolve(this._value):2==c&&(a&&n(a)?h(l(a,d),null,[this._reason]):d.reject(this._reason));return d},"catch":function(b){return this.then(null,b)},_done:function(){for(var b=this._dones,a;a=b.shift();)try{a[0].call(a[1]||null,this._value)}catch(d){z(d)}},done:function(b,a){var d=this._state;if(1==d&&0==this._wait)try{b.call(a||null,this._value)}catch(c){z(c)}else 0==
d&&this._dones.push([b,a]);return this},_fail:function(){for(var b=this._fails,a;a=b.shift();)try{a[0].call(a[1]||null,this._reason)}catch(d){z(d)}},fail:function(b,a){var d=this._state;if(2==d&&0==this._wait)try{b.call(a||null,this._reason)}catch(c){z(c)}else 0==d&&this._fails.push([b,a]);return this},always:function(b,a){this.done(b,a);this.fail(b,a);return this},promise:function(){return{then:m(this.then,this),done:m(this.done,this),fail:m(this.fail,this),always:m(this.always,this)}},after:function(b){var a=
this;if(p(b)){a._wait++;var d=function(){a._wait--;0==a._wait&&0!=a._state&&(1==a._state?a._callResolveHandlers():a._callRejectHandlers())};n(b.done)?b.done(d):b.then(d)}return a}},!0,!1);g.fcall=function(b,a,d){return g.resolve(b.apply(a,d||[]))};g.resolve=function(b){var a=new g;a.resolve(b);return a};g.reject=function(b){var a=new g;a.reject(b);return a};g.all=function(b){if(!b.length)return g.resolve(null);var a=new g,d=b.length,c=Array(d),e=d,f,h,k=function(b,d){c[d]=b;e--;0==e&&a.resolve(c)};
for(f=0;f<d;f++)(function(d){h=b[f];h instanceof g?h.done(function(a){k(a,d)}).fail(a.reject,a):p(h)||n(h)?(new g(h)).done(function(a){k(a,d)}).fail(a.reject,a):k(h,d)})(f);return a};g.when=function(){return g.all(arguments)};g.allResolved=function(b){if(!b.length)return g.resolve(null);var a=new g,d=b.length,c=[],e=d,f,h,k=function(a){c.push(a);l()},l=function(){e--;0==e&&a.resolve(c)};for(f=0;f<d;f++)h=b[f],h instanceof g?h.done(k).fail(l):p(h)||n(h)?(new g(h)).done(k).fail(l):k(h);return a};g.race=
function(b){if(!b.length)return g.resolve(null);var a=new g,d=b.length,c,e;for(c=0;c<d&&(e=b[c],e instanceof g?e.done(a.resolve,a).fail(a.reject,a):p(e)||n(e)?(new g(e)).done(a.resolve,a).fail(a.reject,a):a.resolve(e),a.isPending());c++);return a};g.waterfall=function(b){if(!b.length)return g.resolve(null);for(var a=b.shift(),a=n(a)?g.fcall(a):g.resolve(d),d;d=b.shift();)p(d)?a=a.then(function(a){return function(){return a}}(d)):n(d)?a=a.then(d):a.resolve(d);return a};g.counter=function(b){var a=
new g;a.countdown=function(){b--;0==b&&a.resolve()};return a};return g}(),v=function(){var e,c;if("undefined"!=typeof window){var f=window;e=f.requestAnimationFrame||f.webkitRequestAnimationFrame||f.mozRequestAnimationFrame;c=f.cancelAnimationFrame||f.webkitCancelAnimationFrame||f.mozCancelAnimationFrame||f.webkitCancelRequestAnimationFrame;if(e)return function(f){var h=e(f);return function(){c(h)}}}return function(c){var e=setTimeout(c,0);return function(){clearTimeout(e)}}}(),T=function(){var e=
{show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},c=0,f=M(),k=!!f,h=function(b,a,d){var c=function(){(new Date).getTime()-a>=d?b():v(c)};v(c)},l=function a(d,c,e,f,g,k,n,m){var p=function(){var a=s(d,"mjsAnimationQueue");return a&&a.length&&a[0].id==n?!1:(g.reject(d),!0)},t=function(){if(!p()){var f=e;e++;if(e==c.length){g.resolve(d);s(d,"mjsAnimationQueue").shift();var h=s(d,"mjsAnimationQueue");h.length?(h=h[0],l(h.el,h.stages,0,h.start,h.deferred,!1,
h.id,h.step)):s(d,"mjsAnimationQueue",null)}else s(d,"mjsAnimationQueue")[0].position=e,a(d,c,e,null,g,!1,n,m);y(d,c[f]);y(d,c[f]+"-active")}},q=function(){p()||(K(d,c[e]+"-active"),H.resolve(m&&m(d,e,"active")).done(function(){if(!p()){var a=P(d);a?h(t,(new Date).getTime(),a):v(t)}}))},x=function(){p()||(K(d,c[e]),H.waterfall([m&&m(d,e,"start"),function(){return f?f(d):null}]).done(function(){!p()&&v(q)}))};k?v(x):x()},g=function(a,d,f,g,h,m){var r=new H,v=s(a,"mjsAnimationQueue")||[],y=++c,z=a.getAttribute("mjs-animate"),
t,q,x,u,w,C,I;d=d||z;g&&null===z&&(d=null);if(d){F(d)?"["==d.substr(0,1)?t=(new Function("","return "+d))():(t=e[d],d=h&&h.get("animate."+d,!0)):n(d)?q=d:"object"==typeof d&&5===E(d)&&(F(d[0])?t=d:(x=d[0],u=d[1]));D(d)&&(t=d.stages,q=d.fn,x=d.before,u=d.after,w=d.options?G({},d.options):{},C=d.context||null,I=d.duration||null,f=f||w.start);if(k&&t)return v.push({el:a,stages:t,start:f,step:m,deferred:r,position:0,id:y}),s(a,"mjsAnimationQueue",v),1==v.length&&l(a,t,0,f,r,!0,y,m),r;w=w||{};f&&(w.start=
function(){f(a)});w.complete=function(){r.resolve(a)};I&&(w.duration=I);if(q&&n(q))return x&&G(a.style,x,!0,!1),f&&f(a),s(a,"mjsAnimationQueue",q.call(C,a,function(){r.resolve(a)})),r;if(window.jQuery){d=$(a);x&&d.css(x);s(a,"mjsAnimationQueue","stop");if(q&&F(q))return d[q](w),r;if(u)return d.animate(u,w),r}}f?(q=f(a),p(q)?q.done(function(){r.resolve(a)}):r.resolve(a)):r.resolve(a);return r};g.addAnimationType=function(a,c){e[a]=c};g.stop=N;g.prefixes=f;g.cssAnimations=k;return g}();u.animate=T;
u.stopAnimation=N;"undefined"!=typeof global?global.MetaphorJs=u:window.MetaphorJs=u})();
