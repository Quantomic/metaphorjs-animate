'use strict';(function(){function x(e,b){b&&(e.className=e.className.replace(C("(?:^|\\s)"+b+"(?!\\S)"),""))}function p(e){return"function"==typeof e}function q(e){if(!e)return!1;var b,d;return"object"!=(d=typeof e)&&"function"!=d?!1:p(b=e.then)?b:!1}function D(e){return"object"==typeof e&&3===G(e)&&!e.nodeType&&e.constructor===Object}function L(e){return!0===e||!1===e}function Q(e,b,d,l){setTimeout(function(){e.apply(b,d||[])},l||0)}function z(e){var b=e.stack||Error().stack;if("undefined"!=typeof console&&
console.log)Q(function(){console.log(e);b&&console.log(b)});else throw e;}function M(e,b){var d;if(d=b)d=!(b&&C("(?:^|\\s)"+b+"(?!\\S)").test(e.className));d&&(e.className+=" "+b)}function H(e){return"string"==typeof e||e===""+e}var B=function(){var e=["Moz","Webkit","ms","O","Khtml"],b="animationDelay",d="animationDuration",l="transitionDelay",f="transitionDuration",m="transform",h=null,a=null,c=!1;return function(){if(!c){var g=window.document.createElement("div"),k=!1,A,E,N;if(void 0!==g.style.animationName)k=
!0;else for(E=0,N=e.length;E<N;E++)if(A=e[E],void 0!==g.style[A+"AnimationName"]){k=!0;b=A+"AnimationDelay";d=A+"AnimationDuration";l=A+"TransitionDelay";f=A+"TransitionDuration";m=A+"Transform";break}k&&("ontransitionend"in window?h="transitionend":"onwebkittransitionend"in window&&(h="webkitTransitionEnd"));a=k?{animationDelay:b,animationDuration:d,transitionDelay:l,transitionDuration:f,transform:m,transitionend:h}:{};c=!0}return a}}(),O=function(){var e=function(a){if(!a)return 0;var c=parseFloat(a);
-1==a.indexOf("ms")&&(c*=1E3);return c},b=function(a,c,g){var k,b,d=c.length;for(k=0;k<d;k++)b=e(c[k])+e(g[k]),a=Math.max(b,a);return a},d=!1,l=null,f=null,m=null,h=null;return function(a){!1===d&&(l=(d=B())?d.animationDuration:null,f=d?d.animationDelay:null,m=d?d.transitionDuration:null,h=d?d.transitionDelay:null);if(!d)return 0;var c=window.getComputedStyle?window.getComputedStyle(a,null):a.style;a=0;var g=(c[l]||"").split(","),k=(c[f]||"").split(","),e=(c[m]||"").split(","),c=(c[h]||"").split(",");
a=Math.max(a,b(a,g,k));return a=Math.max(a,b(a,e,c))}}(),R=function(){var e=["0","0","0"];return function(){for(var b=e.length,d;b;){b--;d=e[b].charCodeAt(0);if(57==d)return e[b]="A",e.join("");if(90==d)e[b]="0";else return e[b]=String.fromCharCode(d+1),e.join("")}e.unshift("0");return e.join("")}}(),t=function(){var e={};return function(b,d,l){b=b._mjsid||(b._mjsid=R());var f=e[b];return void 0!==l?(f||(f=e[b]={}),f[d]=l):f?f[d]:void 0}}(),C=function(){var e={};return function(b){return e[b]||(e[b]=
new RegExp(b))}}(),S=Object.prototype.toString,G=function(){var e={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(b){if(!b){if(null===b)return 6;if(void 0===b)return 7}var d=e[S.call(b)];return void 0===d?-1:1==d&&isNaN(b)?8:d}}(),P=function(e){var b=t(e,"mjsAnimationQueue"),d,l;if("object"==typeof b&&5===G(b)&&b.length){if(b=b[0])b.stages&&(d=b.position,l=b.stages,x(e,
l[d]),x(e,l[d]+"-active")),b.deferred&&b.deferred.reject(b.el)}else p(b)?b(e):"stop"==b&&$(e).stop(!0,!0);t(e,"mjsAnimationQueue",null)},T=Array.prototype.slice,I=function(){return function b(){var d=!1,l=!1,f=T.call(arguments),m=f.shift(),h,a,c;L(f[f.length-1])&&(d=f.pop());L(f[f.length-1])&&(l=d,d=f.pop());for(;f.length;)if(h=f.shift())for(a in h)if(h.hasOwnProperty(a)&&void 0!==(c=h[a]))if(l)if(m[a]&&D(m[a])&&D(c))b(m[a],c,d,l);else{if(!0===d||void 0==m[a])D(c)?(m[a]={},b(m[a],c,d,!0)):m[a]=c}else if(!0===
d||void 0==m[a])m[a]=c;return m}}(),n=Function.prototype.bind?function(e,b){return e.bind(b)}:function(e,b){return function(){return e.apply(b,arguments)}},J=function(){var e=[],b=!1,d="undefined"!=typeof process?process.nextTick:function(a){setTimeout(a,0)},l=function(){b=!0;var a=e.shift();d(function(){a[0].apply(a[1],a[2]);e.length?l():b=!1},0)},f=function(a,c,g){g=g||[];e.push([a,c,g]);b||l()},m=function(a,c){return function(g){try{c.resolve(a(g))}catch(k){c.reject(k)}}},h=function(a,c){if(a instanceof
h)return a;if(!(this instanceof h))return new h(a,c);var g;this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(0<arguments.length)if(g=q(a))a instanceof h?a.then(n(this.resolve,this),n(this.reject,this)):(new h(g,a)).then(n(this.resolve,this),n(this.reject,this));else if(p(a))try{a.call(c,n(this.resolve,this),n(this.reject,this))}catch(k){this.reject(k)}else this.resolve(a)};I(h.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,
_triggered:!1,isPending:function(){return 0==this._state},isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){this._fails=this._dones=this._rejects=this._fulfills=null},_processValue:function(a,c){var g;if(0==this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(g=q(a)){a instanceof h?a.then(n(this._processResolveValue,this),n(this._processRejectReason,this)):(new h(g,a)).then(n(this._processResolveValue,
this),n(this._processRejectReason,this));return}}catch(k){0==this._state&&this._doReject(k);return}c.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,c;c=a.shift();)f(c[0],c[1],[this._value]);this._cleanup()},_doResolve:function(a){this._value=a;this._state=1;0==this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,this._doResolve)},resolve:function(a){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(a);
return this},_callRejectHandlers:function(){this._fail();for(var a=this._rejects,c;c=a.shift();)f(c[0],c[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0==this._wait&&this._callRejectHandlers()},_processRejectReason:function(a){this._processValue(a,this._doReject)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);return this},then:function(a,c){var g=new h,k=this._state;0==k||0!=this._wait?(a&&p(a)?this._fulfills.push([m(a,
g),null]):this._fulfills.push([g.resolve,g]),c&&p(c)?this._rejects.push([m(c,g),null]):this._rejects.push([g.reject,g])):1==k?a&&p(a)?f(m(a,g),null,[this._value]):g.resolve(this._value):2==k&&(c&&p(c)?f(m(c,g),null,[this._reason]):g.reject(this._reason));return g},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,c;c=a.shift();)try{c[0].call(c[1]||null,this._value)}catch(g){z(g)}},done:function(a,c){var g=this._state;if(1==g&&0==this._wait)try{a.call(c||null,this._value)}catch(k){z(k)}else 0==
g&&this._dones.push([a,c]);return this},_fail:function(){for(var a=this._fails,c;c=a.shift();)try{c[0].call(c[1]||null,this._reason)}catch(g){z(g)}},fail:function(a,c){var g=this._state;if(2==g&&0==this._wait)try{a.call(c||null,this._reason)}catch(k){z(k)}else 0==g&&this._fails.push([a,c]);return this},always:function(a,c){this.done(a,c);this.fail(a,c);return this},promise:function(){return{then:n(this.then,this),done:n(this.done,this),fail:n(this.fail,this),always:n(this.always,this)}},after:function(a){var c=
this;if(q(a)){c._wait++;var g=function(){c._wait--;0==c._wait&&0!=c._state&&(1==c._state?c._callResolveHandlers():c._callRejectHandlers())};p(a.done)?a.done(g):a.then(g)}return c}},!0,!1);h.fcall=function(a,c,g){return h.resolve(a.apply(c,g||[]))};h.resolve=function(a){var c=new h;c.resolve(a);return c};h.reject=function(a){var c=new h;c.reject(a);return c};h.all=function(a){if(!a.length)return h.resolve(null);var c=new h,g=a.length,k=Array(g),e=g,b,d,f=function(a,g){k[g]=a;e--;0==e&&c.resolve(k)};
for(b=0;b<g;b++)(function(k){d=a[b];d instanceof h?d.done(function(a){f(a,k)}).fail(c.reject,c):q(d)||p(d)?(new h(d)).done(function(a){f(a,k)}).fail(c.reject,c):f(d,k)})(b);return c};h.when=function(){return h.all(arguments)};h.allResolved=function(a){if(!a.length)return h.resolve(null);var c=new h,g=a.length,k=[],b=g,e,d,f=function(a){k.push(a);l()},l=function(){b--;0==b&&c.resolve(k)};for(e=0;e<g;e++)d=a[e],d instanceof h?d.done(f).fail(l):q(d)||p(d)?(new h(d)).done(f).fail(l):f(d);return c};h.race=
function(a){if(!a.length)return h.resolve(null);var c=new h,g=a.length,k,b;for(k=0;k<g&&(b=a[k],b instanceof h?b.done(c.resolve,c).fail(c.reject,c):q(b)||p(b)?(new h(b)).done(c.resolve,c).fail(c.reject,c):c.resolve(b),c.isPending());k++);return c};h.waterfall=function(a){if(!a.length)return h.resolve(null);for(var c=a.shift(),c=p(c)?h.fcall(c):h.resolve(b),b;b=a.shift();)q(b)?c=c.then(function(a){return function(){return a}}(b)):p(b)?c=c.then(b):c.resolve(b);return c};h.counter=function(a){var c=
new h;c.countdown=function(){a--;0==a&&c.resolve()};return c};return h}(),y=function(){var e,b;if("undefined"!=typeof window){var d=window;e=d.requestAnimationFrame||d.webkitRequestAnimationFrame||d.mozRequestAnimationFrame;b=d.cancelAnimationFrame||d.webkitCancelAnimationFrame||d.mozCancelAnimationFrame||d.webkitCancelRequestAnimationFrame;if(e)return function(d){var f=e(d);return function(){b(f)}}}return function(b){var e=setTimeout(b,0);return function(){clearTimeout(e)}}}(),U=function(){var e=
{show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},b=0,d=!1,l=!1,f=function(a,b,k){var e=function(){(new Date).getTime()-b>=k?a():y(e)};y(e)},m=function(){!1===d&&(d=B(),l=!!d);return l},h=function g(a,b,e,d,l,m,p,n){var q=function(){var b=t(a,"mjsAnimationQueue");return b&&b.length&&b[0].id==p?!1:(l.reject(a),!0)},u=function(){if(!q()){var d=e;e++;if(e==b.length){l.resolve(a);t(a,"mjsAnimationQueue").shift();var f=t(a,"mjsAnimationQueue");f.length?(f=
f[0],h(f.el,f.stages,0,f.start,f.deferred,!1,f.id,f.step)):t(a,"mjsAnimationQueue",null)}else t(a,"mjsAnimationQueue")[0].position=e,g(a,b,e,null,l,!1,p,n);x(a,b[d]);x(a,b[d]+"-active")}},r=function(){q()||(M(a,b[e]+"-active"),J.resolve(n&&n(a,e,"active")).done(function(){if(!q()){var b=O(a);b?f(u,(new Date).getTime(),b):y(u)}}))},w=function(){q()||(M(a,b[e]),J.waterfall([n&&n(a,e,"start"),function(){return d?d(a):null}]).done(function(){!q()&&y(r)}))};m?y(w):w()},a=function(a,d,f,l,n,y){var s=new J,
x=t(a,"mjsAnimationQueue")||[],z=++b,B=a.getAttribute?a.getAttribute("mjs-animate"):null,u,r,w,F,v,C,K;d=d||B;l&&null===B&&(d=null);if(d){H(d)?"["==d.substr(0,1)?u=(new Function("","return "+d))():(u=e[d],d=n&&n.get("animate."+d,!0)):p(d)?r=d:"object"==typeof d&&5===G(d)&&(H(d[0])?u=d:(w=d[0],F=d[1]));D(d)&&(u=d.stages,r=d.fn,w=d.before,F=d.after,v=d.options?I({},d.options):{},C=d.context||null,K=d.duration||null,f=f||v.start);if(m()&&u)return x.push({el:a,stages:u,start:f,step:y,deferred:s,position:0,
id:z}),t(a,"mjsAnimationQueue",x),1==x.length&&h(a,u,0,f,s,!0,z,y),s;v=v||{};f&&(v.start=function(){f(a)});v.complete=function(){s.resolve(a)};K&&(v.duration=K);if(r&&p(r))return w&&I(a.style,w,!0,!1),f&&f(a),t(a,"mjsAnimationQueue",r.call(C,a,function(){s.resolve(a)})),s;if(window.jQuery){d=$(a);w&&d.css(w);t(a,"mjsAnimationQueue","stop");if(r&&H(r))return d[r](v),s;if(F)return d.animate(F,v),s}}f?(r=f(a),q(r)?r.done(function(){s.resolve(a)}):s.resolve(a)):s.resolve(a);return s};a.addAnimationType=
function(a,b){e[a]=b};a.stop=P;a.getPrefixes=B;a.getDuration=O;a.cssAnimationSupported=m;return a}();MetaphorJs.animate=U;MetaphorJs.stopAnimation=P;"undefined"!=typeof global?global.MetaphorJs=MetaphorJs:window.MetaphorJs=MetaphorJs})();
