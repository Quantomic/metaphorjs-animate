(function(){var x={lib:{},cmp:{},view:{}},z=function(){var g=["Moz","Webkit","ms","O","Khtml"],d="animationDelay",f="animationDuration",p="transitionDelay",h="transitionDuration",k=null;(function(){var k=document.createElement("div"),e=!1,a,b,c;if(void 0!==k.style.animationName)e=!0;else for(b=0,c=g.length;b<c;b++)if(a=g[b],void 0!==k.style[a+"AnimationName"]){e=!0;d=a+"AnimationDelay";f=a+"AnimationDuration";p=a+"TransitionDelay";h=a+"TransitionDuration";break}return e})()&&(k={animationDelay:d,
animationDuration:f,transitionDelay:p,transitionDuration:h});return function(){return k}}(),J=function(){var g=function(e){if(!e)return 0;var a=parseFloat(e);-1==e.indexOf("ms")&&(a*=1E3);return a},d=function(e,a,b){var c,d,f=a.length;for(c=0;c<f;c++)d=g(a[c])+g(b[c]),e=Math.max(d,e);return e},f=z(),p=f?f.animationDuration:null,h=f?f.animationDelay:null,k=f?f.transitionDuration:null,m=f?f.transitionDelay:null;return function(e){if(!f)return 0;var a=window.getComputedStyle?window.getComputedStyle(e,
null):e.style;e=0;var b=(a[p]||"").split(","),c=(a[h]||"").split(","),g=(a[k]||"").split(","),a=(a[m]||"").split(",");e=Math.max(e,d(e,b,c));return e=Math.max(e,d(e,g,a))}}(),K=function(){var g=["0","0","0"];return function(){for(var d=g.length,f;d;){d--;f=g[d].charCodeAt(0);if(57==f)return g[d]="A",g.join("");if(90==f)g[d]="0";else return g[d]=String.fromCharCode(f+1),g.join("")}g.unshift("0");return g.join("")}}(),q=function(g){return"undefined"==typeof g},n=function(){var g={};return function(d,
f,p){d=d._mjsid||(d._mjsid=K());var h=g[d];if(q(p))return h?h[f]:void 0;h||(h=g[d]={});return h[f]=p}}(),D=function(){var g={};return function(d){return g[d]||(g[d]=new RegExp(d))}}(),y=function(g,d){d&&(g.className=g.className.replace(D("(?:^|\\s)"+d+"(?!\\S)"),""))},m=function(g){return"function"===typeof g},F=function(g){var d=n(g,"mjsAnimationQueue"),f;E(d)&&d.length?(f=d[0])&&f.stages&&(d=f.position,f=f.stages,y(g,f[d]),y(g,f[d]+"-active")):m(d)?d(g):"stop"==d&&$(g).stop(!0,!0);n(g,"mjsAnimationQueue",
null)},L=Object.prototype.toString,E=function(g){var d;if(d=g&&null!=g&&"object"===typeof g)d=g.length,d="number"==typeof d&&!isNaN(d);return!(!d||"[object Array]"!=L.call(g))},w=function(g){var d;return g&&(null!=g&&"object"===typeof g||m(g))?m(d=g.then)?d:!1:!1},M=Array.prototype.slice,A=function(g){return!(!g||g.constructor!==Object)},G=function d(){var f=!1,p=!1,h=M.call(arguments),k=h.shift(),m,e,a;"boolean"==typeof h[h.length-1]&&(f=h.pop());"boolean"==typeof h[h.length-1]&&(p=f,f=h.pop());
for(;h.length;)if(m=h.shift())for(e in m)if(m.hasOwnProperty(e)&&!q(a=m[e]))if(p)if(k[e]&&A(k[e])&&A(a))d(k[e],a,f,p);else{if(!0===f||q(k[e])||null===k[e])A(a)?(k[e]={},d(k[e],a,f,!0)):k[e]=a}else if(!0===f||q(k[e])||null===k[e])k[e]=a;return k},s=Function.prototype.bind?function(d,f){return d.bind(f)}:function(d,f){return function(){return d.apply(f,arguments)}},N=function(d,f,m){setTimeout(function(){d.apply(f,m||[])},0)},H=function(d){var f=d.stack||Error().stack;N(function(){!q(console)&&console.log&&
(console.log(d),f&&console.log(f))})},O=function(){var d=[],f=!1,p="undefined"!=typeof process?process.nextTick:function(a){setTimeout(a,0)},h=function(){f=!0;var a=d.shift();p(function(){a[0].apply(a[1],a[2]);d.length?h():f=!1},0)},k=function(a,b,c){c=c||[];d.push([a,b,c]);f||h()},n=function(a,b){return function(c){try{b.resolve(a(c))}catch(e){b.reject(e)}}},e=function(a,b){if(a instanceof e)return a;if(!(this instanceof e))return new e(a,b);this._fulfills=[];this._rejects=[];this._dones=[];this._fails=
[];if(!q(a))if(w(a)||!m(a))this.resolve(a);else try{a.call(b,s(this.resolve,this),s(this.reject,this))}catch(c){this.reject(c)}};e.prototype={_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0==this._state},isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){delete this._fulfills;delete this._rejects;delete this._dones;delete this._fails},_processValue:function(a,
b){var c;if(0==this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(c=w(a)){a instanceof e?a.then(s(this._processResolveValue,this),s(this._processRejectReason,this)):(new e(c,a)).then(s(this._processResolveValue,this),s(this._processRejectReason,this));return}}catch(d){0==this._state&&this._doReject(d);return}b.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,b;b=a.shift();)k(b[0],b[1],[this._value]);this._cleanup()},
_doResolve:function(a){this._value=a;this._state=1;0==this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,this._doResolve)},resolve:function(a){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(a);return this},_callRejectHandlers:function(){this._fail();for(var a=this._rejects,b;b=a.shift();)k(b[0],b[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0==this._wait&&this._callRejectHandlers()},
_processRejectReason:function(a){this._processValue(a,this._doReject)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);return this},then:function(a,b){var c=new e,d=this._state;0==d||0!=this._wait?(a&&m(a)?this._fulfills.push([n(a,c),null]):this._fulfills.push([c.resolve,c]),b&&m(b)?this._rejects.push([n(b,c),null]):this._rejects.push([c.reject,c])):1==d?a&&m(a)?k(n(a,c),null,[this._value]):c.resolve(this._value):2==d&&(b&&m(b)?k(n(b,c),null,[this._reason]):
c.reject(this._reason));return c},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,b;b=a.shift();)try{b[0].call(b[1]||null,this._value)}catch(c){H(c)}},done:function(a,b){var c=this._state;1==c&&0==this._wait?a.call(b||null,this._value):0==c&&this._dones.push([a,b]);return this},_fail:function(){for(var a=this._fails,b;b=a.shift();)try{b[0].call(b[1]||null,this._reason)}catch(c){H(c)}},fail:function(a,b){var c=this._state;2==c&&0==this._wait?a.call(b||null,this._reason):
0==c&&this._fails.push([a,b]);return this},always:function(a,b){this.done(a,b);this.fail(a,b);return this},promise:function(){return{then:s(this.then,this),done:s(this.done,this),fail:s(this.fail,this),always:s(this.always,this)}},after:function(a){var b=this;if(w(a)){b._wait++;var c=function(){b._wait--;0==b._wait&&0!=b._state&&(1==b._state?b._callResolveHandlers():b._callRejectHandlers())};m(a.done)?a.done(c):a.then(c)}return b}};e.resolve=function(a){return new e(a)};e.reject=function(a){var b=
new e;b.reject(a);return b};e.all=function(a){if(!a.length)return e.resolve(null);var b=new e,c=a.length,d=Array(c),f=c,h,l,k=function(a,c){d[c]=a;f--;0==f&&b.resolve(d)};for(h=0;h<c;h++)(function(c){l=a[h];l instanceof e?l.done(function(a){k(a,c)}).fail(b.reject,b):w(l)||m(l)?(new e(l)).done(function(a){k(a,c)}).fail(b.reject,b):k(l,c)})(h);return b};e.when=function(){return e.all(arguments)};e.allResolved=function(a){if(!a.length)return e.resolve(null);var b=new e,c=a.length,d=[],f=c,h,l,k=function(a){d.push(a);
n()},n=function(){f--;0==f&&b.resolve(d)};for(h=0;h<c;h++)l=a[h],l instanceof e?l.done(k).fail(n):w(l)||m(l)?(new e(l)).done(k).fail(n):k(l);return b};e.race=function(a){if(!a.length)return e.resolve(null);var b=new e,c=a.length,d,f;for(d=0;d<c&&(f=a[d],f instanceof e?f.done(b.resolve,b).fail(b.reject,b):w(f)||m(f)?(new e(f)).done(b.resolve,b).fail(b.reject,b):b.resolve(f),b.isPending());d++);return b};return e}(),I=function(d,f){return f?D("(?:^|\\s)"+f+"(?!\\S)").test(d.className):!1},P=function(){var d=
{show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},f=0,p=!!z(),h=window.requestAnimationFrame?window.requestAnimationFrame:function(a){setTimeout(a,0)},k=function(a,b,c){var d=function(){(new Date).getTime()-b>=c?a():h(d)};h(d)},s=function b(c,d,e,f,l,m,p){var q=function(){var b=n(c,"mjsAnimationQueue");return b&&b.length&&b[0].id==p?!1:(l.reject(c),!0)},t=function(){if(!q()){var f=e;e++;if(e==d.length){l.resolve(c);n(c,"mjsAnimationQueue").shift();var h=
n(c,"mjsAnimationQueue");h.length?(h=h[0],s(h.el,h.stages,0,h.start,h.deferred,!1,h.id)):n(c,"mjsAnimationQueue",null)}else n(c,"mjsAnimationQueue")[0].position=e,b(c,d,e,null,l);y(c,d[f]);y(c,d[f]+"-active")}},r=function(){if(!q()){var b=d[e]+"-active";b&&!I(c,b)&&(c.className+=" "+b);(b=J(c))?k(t,(new Date).getTime(),b):t()}},v=function(){if(!q()){var b=d[e];b&&!I(c,b)&&(c.className+=" "+b);var k;f&&(k=f(c),f=null);w(k)?k.done(r):h(r)}};m?h(v):v()},e=function(b,c,e,h,k){var l=new O,q=n(b,"mjsAnimationQueue")||
[],x=++f,y=b.getAttribute("mjs-animate"),t,r,v,B,u,z,C;c=c||y;h&&null===y&&(c=null);if(c){"string"==typeof c?"["==c.substr(0,1)?t=(new Function("","return "+c))():(t=d[c],c=k&&k.get("animate."+c,!0)):m(c)?r=c:E(c)&&("string"==typeof c[0]?t=c:(v=c[0],B=c[1]));A(c)&&(t=c.stages,r=c.fn,v=c.before,B=c.after,u=c.options?G({},c.options):{},z=c.context||null,C=c.duration||null,e=e||u.start);if(p&&t)return q.push({el:b,stages:t,start:e,deferred:l,position:0,id:x}),n(b,"mjsAnimationQueue",q),1==q.length&&
s(b,t,0,e,l,!0,x),l;u=u||{};e&&(u.start=function(){e(b)});u.complete=function(){l.resolve(b)};C&&(u.duration=C);if(r&&m(r))return v&&G(b.style,v,!0,!1),e&&e(b),n(b,"mjsAnimationQueue",r.call(z,b,function(){l.resolve(b)})),l;if(window.jQuery){c=$(b);v&&c.css(v);n(b,"mjsAnimationQueue","stop");if(r&&"string"==typeof r)return c[r](u),l;if(B)return c.animate(B,u),l}}e?(r=e(b),w(r)?r.done(function(){l.resolve(b)}):l.resolve(b)):l.resolve(b);return l};e.addAnimationType=function(b,c){d[b]=c};e.stop=F;return e}();
x.animate=P;x.stopAnimation=F;"undefined"!=typeof global?global.MetaphorJs=x:window.MetaphorJs=x})();
